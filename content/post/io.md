---
title:       "阻塞/非阻塞IO VS 同步/异步IO"
subtitle:    ""
description: ""
date:        2023-05-29T21:33:46+08:00 
author:      ""
image:       ""
tags:        ["网络编程"]
categories:  ["Tech" ]
katex:       false
---

由于老是把它两搞混，所以就写一下笔记吧  
  
针对网络IO的操作，可以分为**两个阶段**，准备阶段和操作阶段。
1. 准备阶段判断是否能够操作（即等待数据是否可用），在内核进程完成
2. 操作阶段则执行实际的IO调用，数据从内核缓冲区拷贝到用户进程缓冲区  
![](/img/IO1.jpg)  

**以read()操作为例，它会经历下面两个阶段**
1. 等待数据准备，数据是否拷贝到内核缓冲区(pagecache)
2. 将数据从内核拷贝到用户进程空间  

根据这两点，将IO模型分为五类：阻塞IO，非阻塞IO，IO复用，信号驱动，异步IO
1. **阻塞IO**：在准备阶段等待数据准备好，在操作阶段需要将准备好的数据复制到应用进程的缓冲区才能返回。 
![](/img/IO2.jpg) 
2. **非阻塞IO**：在准备阶段如果数据还没准备好，可以立即返回一个错误，应用进程通过轮询的方式来检测某个操作是否就绪。数据就绪后，等待IO操作结束返回  
![](/img/unblockIO.jpg)
3. **IO复用**： 多个IO共用一个同步阻塞接口，任意IO等到数据了就可以激活IO操作，这时候对阻塞IO的改进（主要是select、poll和epoll，实现同时对多个IO端口进行监听），此时阻塞发生在select/poll的系统调用上，而不是阻塞在实际的IO操作上。即通过一个select/poll的系统调用，同时等待多个文件描述符，这些文件描述符其中的任意一个进入就绪状态，select函数就可返回。
4. **信号驱动IO**：注册一个IO信号事件，在数据可操作时通过SIGIO信号通知线程，这应该算是一种异步机制。  
 
**以上四种操作在第一阶段判断是否可操作阶段各不相同，但一旦数据可操作，则切换到同步阻塞模式下执行IO操作，所以都属于同步IO**  
![](/img/synchronizeIO.jpg)  

5. **异步IO**：应用进程通知内核开始一个异步操作，并让内核在整个操作（包含准备阶段、操作阶段）完成后通知应用进程。  
![](/img/asynchronousIO.jpg)

### 参考链接
[深入理解 I/O(阻塞、非阻塞，同步、异步)的概念及其区别](https://zhuanlan.zhihu.com/p/270010926)  

[小林图解系统-文件系统](https://xiaolincoding.com/os/6_file_system/file_system.html#阻塞与非阻塞-i-o-vs-同步与异步-i-o)